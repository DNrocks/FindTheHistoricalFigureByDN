<!DOCTYPE html>
<html>
<head>
    <title>Personality Insight</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
            line-height: 1.6;
        }
        .container {
            background-color: #ffffff;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        h2 {
            color: #4CAF50;
            font-size: 24px;
            margin-bottom: 10px;
        }
        input[type="text"], input[type="number"] {
            width: calc(100% - 20px);
            padding: 10px;
            margin: 10px 0;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 16px;
        }
        .button {
            display: inline-block;
            padding: 10px 20px;
            font-size: 16px;
            color: white;
            background-color: #4CAF50;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            margin: 10px 0;
        }
        .button:hover {
            background-color: #45a049;
        }
        .question {
            display: none;
            margin: 20px 0;
        }
        .question.active {
            display: block;
        }
        .radio-group {
            display: flex;
            justify-content: space-between;
            margin: 10px 0;
        }
        .radio-option {
            text-align: center;
            flex: 1;
        }
        .radio-option label {
            display: block;
            margin-top: 5px;
        }
        .result {
            display: none;
            margin-top: 20px;
            padding: 20px;
            background-color: #f8f9fa;
            border-radius: 8px;
        }
        .loader {
            display: none;
            text-align: center;
            margin: 20px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <div id="personal-info">
            <h2>Welcome</h2>
            <p>Please provide some information to get started:</p>
            <input type="text" id="name" placeholder="Your name" required>
            <input type="number" id="age" placeholder="Your age" required>
            <input type="text" id="city" placeholder="Your city" required>
            <input type="text" id="goals" placeholder="What are your main goals in life?" required>
            <button class="button" onclick="startQuiz()">Start</button>
        </div>

        <div id="quiz" style="display: none;">
            <div class="question active" data-dimension="EI">
                <h3>How do you prefer to spend your free time?</h3>
                <div class="radio-group">
                    <div class="radio-option">
                        <input type="radio" name="q1" value="E">
                        <label>At social gatherings</label>
                    </div>
                    <div class="radio-option">
                        <input type="radio" name="q1" value="I">
                        <label>In quiet solitude</label>
                    </div>
                </div>
            </div>
            <!-- Add more questions as needed -->
            <button class="button" onclick="nextQuestion()">Next</button>
        </div>

        <div class="result" id="result">
            <h2>Insight</h2>
            <p id="historical-match">Loading your match...</p>
        </div>

        <div class="loader" id="loader">
            <p>Loading...</p>
        </div>
    </div>

    <script>
        let currentQuestion = 0;
        let answers = {};
        let mbtiDimensions = {
            EI: { E: 0, I: 0 },
            SN: { S: 0, N: 0 },
            TF: { T: 0, F: 0 },
            JP: { J: 0, P: 0 }
        };

        function startQuiz() {
            const name = document.getElementById('name').value;
            const age = document.getElementById('age').value;
            const city = document.getElementById('city').value;
            const goals = document.getElementById('goals').value;

            if (!name || !age || !city || !goals) {
                alert('Please fill in all fields');
                return;
            }

            document.getElementById('personal-info').style.display = 'none';
            document.getElementById('quiz').style.display = 'block';
        }

        function nextQuestion() {
            const questions = document.getElementsByClassName('question');
            const currentQ = questions[currentQuestion];
            const radios = currentQ.getElementsByTagName('input');
            let answered = false;

            for (let radio of radios) {
                if (radio.checked) {
                    answered = true;
                    const dimension = currentQ.dataset.dimension;
                    const value = radio.value;
                    mbtiDimensions[dimension][value]++;
                    break;
                }
            }

            if (!answered) {
                alert('Please select an answer before continuing');
                return;
            }

            currentQ.classList.remove('active');
            currentQuestion++;

            if (currentQuestion < questions.length) {
                questions[currentQuestion].classList.add('active');
            } else {
                showResults();
            }
        }

        async function showResults() {
            document.getElementById('quiz').style.display = 'none';
            document.getElementById('loader').style.display = 'block';

            const type = [
                mbtiDimensions.EI.E > mbtiDimensions.EI.I ? 'E' : 'I',
                mbtiDimensions.SN.S > mbtiDimensions.SN.N ? 'S' : 'N',
                mbtiDimensions.TF.T > mbtiDimensions.TF.F ? 'T' : 'F',
                mbtiDimensions.JP.J > mbtiDimensions.JP.P ? 'J' : 'P'
            ].join('');

            const goals = document.getElementById('goals').value;
            const age = document.getElementById('age').value;

            const prompt = `Given a person with the following characteristics:
            - Personality Type: ${type}
            - Age: ${age}
            - Life Goals: ${goals}

            Identify and explain which historical figure best matches this profile, focusing on personality traits and life goals alignment.`;

            try {
                const response = await fetch("https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=AIzaSyBiu0u08-0y7WqAFQgI1N4gTp3pN3uZSP0", {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        contents: [{
                            parts: [{ text: prompt }]
                        }]
                    })
                });

                const data = await response.json();
                const matchText = data.candidates[0].content.parts[0].text;

                document.getElementById('loader').style.display = 'none';
                document.getElementById('result').style.display = 'block';
                document.getElementById('historical-match').textContent = matchText;
            } catch (error) {
                document.getElementById('loader').style.display = 'none';
                document.getElementById('result').style.display = 'block';
                document.getElementById('historical-match').textContent = 'Unable to fetch your match at this time. Please try again later.';
                console.error('Error:', error);
            }
        }
    </script>
</body>
</html>
